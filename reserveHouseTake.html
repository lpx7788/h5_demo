<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache">
	<meta http-equiv="Expires" content="0">

	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="format-detection" content="telephone=no" />
	<title>奥特斯</title>
	<link rel="stylesheet" href="css/swiper-4.3.5.min.css" />
	<link rel="stylesheet" href="css/public.css?v=20180910" />
	<link rel="stylesheet" href="css/reserver.css?v=20180910" />
</head>
<body> <!-- hideHead hideFoot -->
	<div class="webHead df hao jcb" id="webHead">
		<div class="h-btn h-btn-back" toLocation="back"></div>
		<div class="flex h-txt">房型预订</div>
		<div class="h-btn"></div>
	</div>

	<div class="webBody" id="webBody">
		<div class="houseWrite" id="reserveHouseItem">
			<!-- <div class="houseWrite-good">支付成功您将获得0积分</div> -->

			<div class="houseWrite-info">
				<img src="" alt="">
				<span class="ov-d">--</span>
				<em class="price">0</em>
				<em class="info">积分抵扣0</em>
			</div>
	
			<div class="formBox">
				<div class="formLine df hao jcb houseWrite-date">
					<div class="cap">选择时间</div>
					<div class="date df hao" onclick="chooseData()"><em class="startDate" bs="入住时间"></em>至<em class="endDate" bs="离店时间"></em></div>
				</div>
			</div>

			<div class="formBox">
				<div class="formLine df hao jcb houseWrite-person" id="houseWritePersonItem">
					<div class="cap">选择人数</div>
					<!-- <div class="txt arrow" onclick="choosePerson()">1</div> -->
					<div class="input flex"><input type="number" placeholder="请填写人数" onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}" onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'0')}else{this.value=this.value.replace(/\D/g,'')}" /></div>
				</div>
			</div>

			<div class="formBox">
				<div class="formLine df hao jcb houseWrite-level" id="houseWriteLevelItem">
					<div class="cap">选择权益卡</div>
					<div class="txt arrow" onclick="chooseLevel()"></div>
				</div>
			</div>

			<div class="formBox">
				<div class="formLine df hao jcb houseWrite-imp" id="houseWriteImpItem">
					<div class="cap">入住人详细信息<em></em></div>
				</div>
				<div class="formLine df hao jcb houseWrite-imp-name">
					<div class="cap cap2">姓名</div>
					<div class="input"><input type="text" placeholder="请填写身份证姓名" /></div>
				</div>
				<div class="formLine df hao jcb houseWrite-imp-phone">
					<div class="cap cap2">联系电话</div>
					<div class="input"><input type="text" placeholder="请填写联系电话" /></div>
				</div>
				<div class="formLine df hao jcb houseWrite-imp-idcard">
					<div class="cap cap2">身份证号码</div>
					<div class="input"><input type="text" placeholder="请填写身份证号码" /></div>
				</div>
			</div>

			<div class="morePerson" id="houseWriteMorePersonItem"></div>

			<div class="formBox">
				<div class="formLine df hao jcb houseWrite-mode">
					<div class="cap">兑换及抵扣方式</div>
				</div>
				<div class="formLine df hao jcb houseWrite-mode-money">
					<div class="cap cap2">余额</div>
					<div class="info">1000(现有)</div>
					<div class="input smallInput"><input type="text" placeholder="输入数值" /></div>
				</div>
				<div class="formLine df hao jcb houseWrite-mode-score">
					<div class="cap cap2">积分</div>
					<div class="info">1000(现有)</div>
					<div class="input smallInput"><input type="text" placeholder="输入数值" /></div>
				</div>
			</div>
		</div>
	</div>

	<div class="webFoot df hao jcb" id="webFoot">
		<div class="df hao f-shopCount">
			<span>￥5600.00</span>
			<em>已优惠￥100.00</em>
		</div>
		<div class="f-btn f-btn-blue flex" toLocation="reserveHouseOrder.html">立即支付</div>
	</div>

	<div class="chooseLevel" id="chooseLevelItem">
		<div class="etx">
			<div class="top">
				<div class="back" onclick="closeChooseLevel(1)"></div>
				<span>选择权益卡</span>
			</div>
			<div class="content">
				<div class="li df cf wao" dw="金卡" onclick="chooseLevelLi(this)">
					<span>金卡</span>
					<em><i>剩余使用次数:X次</i><i>节假日现价3折优惠</i></em>
				</div>
				<div class="li df cf wao" dw="砖石卡" onclick="chooseLevelLi(this)">
					<span>砖石卡</span>
					<em><i>剩余使用次数:X次</i><i>节假日现价3折优惠</i></em>
				</div>
				<div class="li df cf wao" dw="七星卡" onclick="chooseLevelLi(this)">
					<span>七星卡</span>
					<em><i>剩余使用次数:X次</i><i>节假日现价3折优惠</i></em>
				</div>
			</div>
		</div>
	</div>

	<div class="choosePerson" id="choosePersonItem">
		<div class="etx">
			<div class="top">
				<div class="back" onclick="closeChoosePerson(1)"></div>
				<span>选择人数</span>
			</div>
			<div class="content">
				<div class="li" dw="1" onclick="choosePersonLi(this)">1人</div>
				<div class="li" dw="2" onclick="choosePersonLi(this)">2人</div>
				<div class="li" dw="3" onclick="choosePersonLi(this)">3人</div>
				<div class="li" dw="4" onclick="choosePersonLi(this)">4人</div>
				<div class="li" dw="5" onclick="choosePersonLi(this)">5人</div>
				<div class="li" dw="6" onclick="choosePersonLi(this)">6人</div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="js/swiper-4.3.5.min.js"></script>
<script type="text/javascript" src="js/public.js?v=20180912"></script>
<script type="text/javascript">
	var oid = getUrlParam('oid','');
	if(oid){
		var chooseDateStart = chooseDateEnd = '';
		var reserveHouseArr = {};
		reserveHouseInit();
		function reserveHouseInit(){
			ajax({
				url: '@server/act=store&op=store_detail',
				param: {
					store_id: oid,
				},
				call: function(r){
					// cs(r);
					reserveHouseArr = r[0];
					var infoHtml = '<img src="'+reserveHouseArr.store_pic[0]+'" alt="">'+
									'<span class="ov-d">'+reserveHouseArr.store_name+'</span>'+
									'<em class="price">'+reserveHouseArr.price+'</em>'+
									'<em class="info">积分抵扣'+reserveHouseArr.deduct_points+'</em>';
					$('#reserveHouseItem .houseWrite-info').html(infoHtml);
				}
			});
		}

		function chooseData(){
			initChooseDate({
				title: '请选择预定时间',
				section: true, // 是否选择区间
				initSection: { // 初始化日期区间 section为true时生效
					start: chooseDateStart,
					end: chooseDateEnd,
				},
				canChooseLast: false, // 是否可以选择过去的日期
				call: function(j){
					// console.log(j);
					chooseDateStart = j.startDate.replace(/\//g,'-');
					chooseDateEnd = j.endDate.replace(/\//g,'-');

					$('#reserveHouseItem .houseWrite-date .date em.startDate').text(chooseDateStart);
					$('#reserveHouseItem .houseWrite-date .date em.endDate').text(chooseDateEnd);

					// 获取入住期间价格
					ajax({
						url: '@server/act=store&op=getPriceBytime',
						param: {
							store_id: oid,
							check_in_time: chooseDateStart,
							check_out_time: chooseDateEnd,
						},
						call: function(r){
							cs(r);
							// $('#reserveHouseItem .houseWrite-info').html(infoHtml);
						}
					});
				}
			});
		}



		// key	是	string	token
		// store_id	否	ibt	套餐ID
		// adult_name	否	array	成人名字
		// adult_phone	否	array	手机号码
		// adult_num	否	array	数量数量
		// child_num	否	string	儿童数量
		// adult_card	否	string	成人名字
		// child_name	否	string	儿童姓名
		// available_predeposit	否	string	现金余额
		// member_currency	否	string	旅游币
		// member_points	否	string	积分
		// house_num	否	string	房间数
		// go_date	否	string	出行日期
		// date_id	否	string	出行日期id
		// 
		// function buyHouse(){
		// 	window.location.href = 'reserveHouseTake.html?oid='+oid;
		// }
	}else{
		alerts('参数错误');
	}
	
	function chooseLevel(){
		$('#chooseLevelItem').show().find('.li').removeClass('cur');
		var choose = $('#houseWriteLevelItem .txt').text();
		if(choose){
			$('#chooseLevelItem .li[dw="'+choose+'"]').addClass('cur');
		}
	}

	function closeChooseLevel(s){
		$('#chooseLevelItem').hide();
		if(s==1){
			$('#houseWriteLevelItem .txt').empty();
		}
	}

	function chooseLevelLi(obj) {
		$('#houseWriteLevelItem .txt').text($(obj).attr('dw'));
		closeChooseLevel();
	}

	function choosePerson(){
		$('#choosePersonItem').show().find('.li').removeClass('cur');
		var choose = $('#houseWritePersonItem .txt').text();
		if(choose){
			$('#choosePersonItem .li[dw="'+choose+'"]').addClass('cur');
		}
	}

	function closeChoosePerson(s){
		$('#choosePersonItem').hide();
		if(s==1){
			$('#houseWritePersonItem .txt').text(1);
		}
	}

	function choosePersonLi(obj) {
		var s = $(obj).attr('dw');
		$('#houseWritePersonItem .txt').text(s);
		closeChoosePerson();

		var html = '';
		for(var i=1;i<=s-1;i++){
			html += '<div class="formBox">'+
						'<div class="formLine df hao jcb houseWrite-imp-name">'+
							'<div class="cap cap2">姓名</div>'+
							'<div class="input"><input type="text" placeholder="请填写身份证姓名" /></div>'+
						'</div>'+
						'<div class="formLine df hao jcb houseWrite-imp-phone">'+
							'<div class="cap cap2">联系电话</div>'+
							'<div class="input"><input type="text" placeholder="请填写联系电话" /></div>'+
						'</div>'+
						'<div class="formLine df hao jcb houseWrite-imp-idcard">'+
							'<div class="cap cap2">身份证号码</div>'+
							'<div class="input"><input type="text" placeholder="请填写身份证号码" /></div>'+
						'</div>'+
					'</div>';
		}

		if(s==1){
			$('#houseWriteImpItem .cap em').empty();
		}else{
			$('#houseWriteImpItem .cap em').text('('+s+'人)');
		}
		$('#houseWriteMorePersonItem').html(html);
	}
</script>
</html>